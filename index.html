<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI í…ìŠ¤íŠ¸ ë¶„ì„ê¸°</title>
    <!-- Tailwind CSS ë¶ˆëŸ¬ì˜¤ê¸° -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ ìŠ¤íƒ€ì¼ */
        .loader {
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        .mini-loader {
            border: 2px solid #e5e7eb;
            border-top: 2px solid #3b82f6;
            width: 20px;
            height: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* ì»¤ìŠ¤í…€ ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .radio-label input:checked + div {
            background-color: #eff6ff;
            border-color: #3b82f6;
            color: #1e40af;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen py-12">

    <div class="container mx-auto p-4 md:p-8 max-w-3xl">
        <div class="bg-white p-8 rounded-2xl shadow-2xl">
            
            <div class="text-center mb-10">
                <h1 class="text-4xl font-bold text-slate-800">AI í…ìŠ¤íŠ¸ ë¶„ì„ê¸°</h1>
                <p class="text-slate-500 mt-3">AI ê¸°ë°˜ í…ìŠ¤íŠ¸ ì‹¬ì¸µ ë¶„ì„ ë„êµ¬</p>
            </div>

            <!-- í…ìŠ¤íŠ¸ ì…ë ¥ ì˜ì—­ -->
            <div class="mb-6">
                <label for="original-text" class="text-lg font-semibold text-slate-700 mb-2 block">ì›ë¬¸ í…ìŠ¤íŠ¸</label>
                <textarea id="original-text" rows="12" class="w-full p-4 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition resize-none" placeholder="ë‰´ìŠ¤ ê¸°ì‚¬, ë³´ê³ ì„œ, ë…¼ë¬¸ ë“± ë¶„ì„í•˜ê³  ì‹¶ì€ ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            </div>

            <!-- ìš”ì•½ ì˜µì…˜ -->
            <div class="mb-8">
                <label class="text-lg font-semibold text-slate-700 mb-3 block">ìš”ì•½ ê¸¸ì´</label>
                <div class="grid grid-cols-3 gap-3">
                    <label class="radio-label cursor-pointer">
                        <input type="radio" name="summary-length" value="í•µì‹¬ í•œ ë¬¸ì¥" class="sr-only">
                        <div class="text-center p-3 border-2 border-slate-200 rounded-lg transition hover:border-blue-400">í•µì‹¬ 1ì¤„</div>
                    </label>
                    <label class="radio-label cursor-pointer">
                        <input type="radio" name="summary-length" value="ì„¸ ë¬¸ì¥" class="sr-only" checked>
                        <div class="text-center p-3 border-2 border-slate-200 rounded-lg transition hover:border-blue-400">ê¸°ë³¸ 3ì¤„</div>
                    </label>
                    <label class="radio-label cursor-pointer">
                        <input type="radio" name="summary-length" value="ìì„¸í•œ ìš”ì•½ (5ë¬¸ì¥)" class="sr-only">
                        <div class="text-center p-3 border-2 border-slate-200 rounded-lg transition hover:border-blue-400">ìì„¸íˆ 5ì¤„</div>
                    </label>
                </div>
            </div>

            <div class="text-center">
                <button onclick="runAnalysis()" class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-10 rounded-full text-lg transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                    ë¶„ì„ ì‹¤í–‰í•˜ê¸° ğŸš€
                </button>
            </div>

            <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
            <div id="result-container" class="mt-12 hidden">
                <div class="flex justify-center mb-4">
                    <div id="loader" class="loader"></div>
                </div>
                <p id="status" class="text-center font-semibold text-blue-700 mb-6"></p>

                <div id="analysis-output" class="hidden space-y-6">
                    <!-- ìš”ì•½ ê²°ê³¼ -->
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold text-slate-800">ğŸ“ AI ìš”ì•½ ê²°ê³¼</h2>
                            <button onclick="copyToClipboard(summaryTextElement.innerText, 'ìš”ì•½ ë‚´ìš©ì´')" class="flex items-center bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg text-sm transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                                ë³µì‚¬í•˜ê¸°
                            </button>
                        </div>
                        <div id="summary-text" class="text-slate-700 leading-relaxed whitespace-pre-wrap"></div>
                    </div>
                    <!-- ë¶€ê°€ ê¸°ëŠ¥ ê²°ê³¼ 1 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-slate-50 p-6 rounded-lg">
                             <h2 class="text-xl font-bold text-slate-800 mb-4">ğŸ”‘ í•µì‹¬ í‚¤ì›Œë“œ</h2>
                             <div id="keywords-list" class="flex flex-wrap gap-2"></div>
                        </div>
                        <div class="bg-slate-50 p-6 rounded-lg">
                             <h2 class="text-xl font-bold text-slate-800 mb-4">ğŸ“Š í…ìŠ¤íŠ¸ ë‚œì´ë„</h2>
                             <p id="difficulty-level" class="text-2xl font-bold text-blue-600"></p>
                        </div>
                    </div>
                    <!-- ì–´íœ˜ ê²€ìƒ‰ ê¸°ëŠ¥ -->
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">ğŸ“– ê¶ê¸ˆí•œ ì–´íœ˜ ê²€ìƒ‰</h2>
                        <div class="flex flex-col sm:flex-row gap-2">
                            <input type="text" id="vocab-input" class="w-full p-2 border border-slate-300 rounded-lg" placeholder="ë³¸ë¬¸ ì† ëª¨ë¥´ëŠ” ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                            <button onclick="searchVocabulary()" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg transition whitespace-nowrap">ê²€ìƒ‰</button>
                        </div>
                        <div id="vocab-result" class="mt-4 text-slate-700 min-h-[3rem]"></div>
                    </div>
                    <!-- ì˜ˆìƒ ì§ˆë¬¸ ìƒì„± ê²°ê³¼ -->
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">ğŸ¤” ì˜ˆìƒ ì§ˆë¬¸</h2>
                        <ul id="questions-list" class="list-decimal list-inside space-y-2 text-slate-700"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const originalTextInput = document.getElementById('original-text');
        const resultContainer = document.getElementById('result-container');
        const loader = document.getElementById('loader');
        const statusElement = document.getElementById('status');
        const analysisOutput = document.getElementById('analysis-output');
        const summaryTextElement = document.getElementById('summary-text');
        const keywordsListElement = document.getElementById('keywords-list');
        const difficultyLevelElement = document.getElementById('difficulty-level');
        const vocabInput = document.getElementById('vocab-input');
        const vocabResult = document.getElementById('vocab-result');
        const questionsListElement = document.getElementById('questions-list');
        
        function copyToClipboard(text, subject) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert(`${subject} í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } catch (err) {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
            document.body.removeChild(textArea);
        }

        async function runAnalysis() {
            const textToAnalyze = originalTextInput.value;
            if (textToAnalyze.trim().length < 100) {
                alert("ë¶„ì„í•  ë‚´ìš©ì´ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤. ìµœì†Œ 100ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            const selectedLength = document.querySelector('input[name="summary-length"]:checked').value;

            resultContainer.classList.remove('hidden');
            loader.style.display = 'block';
            statusElement.textContent = 'AIê°€ í…ìŠ¤íŠ¸ë¥¼ ì •ë°€ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
            analysisOutput.classList.add('hidden');
            vocabResult.innerHTML = ''; // ì´ì „ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”

            try {
                const prompt = `
                    ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•´ì„œ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì¤˜.
                    1. 'summary': '${selectedLength}' í˜•ì‹ìœ¼ë¡œ ìš”ì•½í•œ ë‚´ìš©
                    2. 'keywords': ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬ í‚¤ì›Œë“œ 5ê°œë¥¼ ë‹´ì€ ë°°ì—´
                    3. 'difficulty': í…ìŠ¤íŠ¸ì˜ ë‚œì´ë„ë¥¼ "ì´ˆê¸‰", "ì¤‘ê¸‰", "ê³ ê¸‰" ì¤‘ í•˜ë‚˜ë¡œ í‰ê°€
                    4. 'questions': ì´ í…ìŠ¤íŠ¸ì˜ í•µì‹¬ ë‚´ìš©ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ì˜ˆìƒ ì§ˆë¬¸ 3ê°œë¥¼ ë‹´ì€ ë°°ì—´

                    ---
                    ${textToAnalyze}
                `;
                
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { 
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "application/json",
                    }
                };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API ìš”ì²­ ì‹¤íŒ¨: ${response.statusText}`);

                const result = await response.json();
                const analysisData = JSON.parse(result.candidates[0].content.parts[0].text);
                
                // --- ê²°ê³¼ í™”ë©´ ì—…ë°ì´íŠ¸ ---
                summaryTextElement.textContent = analysisData.summary;
                
                keywordsListElement.innerHTML = '';
                analysisData.keywords.forEach(keyword => {
                    const keywordElement = document.createElement('span');
                    keywordElement.className = 'bg-blue-100 text-blue-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded-full';
                    keywordElement.textContent = keyword;
                    keywordsListElement.appendChild(keywordElement);
                });

                difficultyLevelElement.textContent = analysisData.difficulty;
                
                questionsListElement.innerHTML = '';
                analysisData.questions.forEach(question => {
                    const li = document.createElement('li');
                    li.textContent = question;
                    questionsListElement.appendChild(li);
                });

                loader.style.display = 'none';
                statusElement.textContent = 'âœ… ë¶„ì„ ì™„ë£Œ!';
                analysisOutput.classList.remove('hidden');

            } catch (error) {
                loader.style.display = 'none';
                statusElement.textContent = 'âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                console.error(error);
            }
        }
        
        async function searchVocabulary() {
            const word = vocabInput.value.trim();
            if (!word) {
                alert('ê²€ìƒ‰í•  ë‹¨ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            vocabResult.innerHTML = '<div class="loader mini-loader"></div>';

            try {
                const prompt = `'${word}'ë¼ëŠ” ë‹¨ì–´ì˜ ëœ»ì„ ì§§ê³  ê°„ê²°í•˜ê²Œ ì„¤ëª…í•´ì¤˜.`;
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const result = await response.json();
                const definition = result.candidates[0].content.parts[0].text;
                
                vocabResult.innerHTML = `<p>${definition}</p>`;

            } catch (error) {
                vocabResult.innerHTML = '<p class="text-red-500">ë‹¨ì–´ ëœ»ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
                console.error(error);
            }
        }
    </script>

</body>
</html>
